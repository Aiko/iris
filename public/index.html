<!-- AIKO MAIL, INC. ALL RIGHTS RESERVED -->

<!DOCTYPE html>
<html>

<head>
  <!-- ? Meta -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="Aiko AI">
  <title>Inbox</title>
  <link rel="icon" href="assets/img/favicon.png" type="image/png">
  <!-- ? Base CSS -->
  <link rel="stylesheet" href="assets/css/style.css">
  <link rel="stylesheet" href="assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/css/loader.css">
  <!-- ? jQuery -->
  <script src="assets/js/third-party/jquery.min.js"></script>
  <script>
    window.jQuery = window.$ = require('jquery') // the things I do for Ruben
  </script>
  <!--? Using unsafe eval for Vue but if there comes a day when we aren't you are welcome to the below CSP -->
  <!--<meta http-equiv="Content-Security-Policy"
      content="default-src 'self' data:; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' data: 'unsafe-inline'; connect-src *">-->
</head>

<body class="bg">

  <div id="app" :class="{
    'inline-flex': true,
    'collapsed': collapseSidebar || zenMode,
    'zen': zenMode
  }" style="opacity: 0" :style="'padding-top: ' + (isFullScreen ? '0' : '25') + 'px;'">

    <!--? Prestyled themes -->
    <link v-if="isDarkMode" rel="stylesheet" href="assets/css/dark.css">
    <!--? User styles -->
    <link rel="stylesheet" href="assets/css/custom.css">

    <!--? Loader -->
    <div id="fixed" class="aiko-loader center-loader">
      <div class="hide-whole"></div>
      <img src="assets/img/logo.svg">
      <div class="overwrap">
        <div class='wrap'>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
          <div class='c'></div>
        </div>
      </div>
      <div id="load-text">Optimizing content</div>
      <div id="load-text2">Setting up your mailbox</div>
      <div id="load-text3">Almost done</div>
      <div id="load-text4">This will only happen once</div>
      <div id="load-text5">Just a moment</div>
      <!-- Button trigger modal -->
      <div>
        <button type="button" class="btn btn-primary wv">
          Watch a demo
        </button>
        <p class="wv">Get familiar with Aiko Mail while you wait.</p>
      </div>
      <!-- Modal -->
      <div class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content">
            <div class="modal-body">
              <video controls src="assets/videos/initial.mp4" playsinline>
            </div>
            <div class="modal-footer">
              <p style="margin-bottom: 0;">You can skip this video once we're done setting up your
                mailbox.</p>
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Skip Video</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!--? Control Bar -->
    <div :class="{'control-bar': true,'pc': isPC,}" v-if="!isFullScreen">
      <p v-if="isLinux" title="Close" @click="close"></p> <!-- Close ------------------------>
      <p v-if="isLinux" title="Minimize" @click="minimize"></p> <!-- Minimize ------------------------>
      <p v-if="isLinux" title="Full Screen" @click="fullscreen"></p> <!-- Full Screen ------------------------>

      <h5 @click="flow.showDev = true">{{hash.substring(0, 9)}}</h5>


      <h1 title="Minimize" @click="minimize"><img :src="$root.resolveIcon('assets/icons/top-minimize.png')" width="10">
      </h1>
      <!-- Minimize ---------->
      <h1 v-if="!isMaximized" title="Maximize" @click="maximize"><img
          :src="$root.resolveIcon('assets/icons/top-expand.png')" width="10">
      </h1>
      <h1 v-if="isMaximized" title="Unmaximize" @click="unmaximize"><img
          :src="$root.resolveIcon('assets/icons/top-expand.png')" width="10">
      </h1>
      <!-- Maximize -->
      <h1 title="Close" @click="close"><img :src="$root.resolveIcon('assets/icons/top-close.png')" width="10"></h1>
      <!-- Close ---------------->
    </div>

    <!--? Sidebar -->
    <div class="sidebar">
      <div class="container">

        <!--? Mail Section -->
        <div class="row">

          <!--? Open Composer -->
          <a class="sbtn compose-button" @click="openComposer()" id="step6">
            <img :src="$root.resolveIcon('assets/icons/sidebar-edit.svg')"
              style="margin-right: 6px;"
              class="no-filter">
            <span>Compose</span>
          </a>

          <!--? Spaces -->
          <a class="active space-picker home">

            <!--? Home Space -->
            <div class="space">
              <img :src="$root.resolveIcon('assets/icons/sidebar-home.svg')">
              <span>Home <span class="main-count">{{smartPriorityUnread}}</span></span>
            </div>

            <!--? Custom Spaces -->
            <div class="space">
              <img :src="$root.resolveIcon('assets/icons/sidebar-home.svg')">
              <span>ASR</span>
              <div class="dropdown custd">
                <div title="Board options"><img :src="$root.resolveIcon('assets/icons/board-dots.svg')"></div>
                <div class="dropdown-menu">
                  <span>Rename</span>
                  <span class="red">Delete</span>
                </div>
              </div>
            </div>

            <!--? Add New Space -->
            <div class="space">
              <img :src="$root.resolveIcon('assets/icons/header-plus.svg')">
              <span>Add space</span>
            </div>
          </a>

          <!--? Outbox -->
          <a>
            <img :src="$root.resolveIcon('assets/icons/out.svg')" class="mt0">
            <span class="blue">Outbox <span class="main-count">3</span></span>
          </a>

          <!--? Special Folders -->
          <a @click.stop.prevent="flow.showSent = true">
            <img :src="$root.resolveIcon('assets/icons/sidebar-send.svg')" class="sent-fix">
            <span>Sent</span>
          </a>
          <a>
            <img :src="$root.resolveIcon('assets/icons/sidebar-star.svg')" class="off-star">
            <span>Starred</span>
          </a>
          <a>
            <img :src="$root.resolveIcon('assets/icons/sidebar-spam.svg')" style="margin-top: -2px !important;">
            <span>Spam <span class="main-count">4</span></span>
          </a>
          <a>
            <img :src="$root.resolveIcon('assets/icons/sidebar-drafts.svg')">
            <span>Drafts</span>
          </a>
          <a>
            <img :src="$root.resolveIcon('assets/icons/sidebar-trash.svg')">
            <span>Trash</span>
          </a>
        </div>

        <!--? Team Section -->
        <div class="row sr2" style="display: none;">
          <div class="search no-mobile sc">
            <img :src="$root.resolveIcon('assets/icons/header-search.svg')">
            <input type="" name="" placeholder="Search Team">
          </div>
          <div class="user-list">
            <a class="user" v-for="user in profile.team.team">
              <div class="user-in">
                <img :src="user.member.avatar">
                <div class="no-mobile sc">{{user.member.name}}</div>
                <span><img :src="$root.resolveIcon('assets/icons/sidebar-edit.svg')"> New email</span>
              </div>
            </a>

          </div>
          <a class="invite-icon" tflow="down">
            <img :src="$root.resolveIcon('assets/icons/sidebar-invite.svg')">
            <span class="blue sc">Invite</span>
          </a>

        </div>

        <!--? Interactions Section -->
        <div class="announce sc no-mobile" style="display: none;">
          <h1><span class="blue fw700">Send an invite</span></h1>
          <p>You have 3 VIP invites remaining</p>
          <a target="_blank" class="sbtn">Invite now</a>
          <a target="_blank" class="sbtn-sec">Later</a>
        </div>
        <div class="announce sc no-mobile load-sidebar" style="display: none;">
          <h1><span class="blue fw700">Downloading Update</span></h1>
          <p>Do not quit the app during the download.</p>
        </div>
        <div class="announce sc no-mobile load-sidebar" style="display: none">
          <h1><span class="blue fw700">Update Ready</span></h1>
          <p>Restart to install.</p>
          <a target="_blank" class="sbtn">Restart Now</a>
        </div>
        <div class="announce sc no-mobile" style="display: none;">
          <h1>Version: <span class="blue fw700">ALPHA</span></h1>
          <p>Request features and report issues</p>
          <a target="_blank" class="sbtn">Give feedback</a>
        </div>

        <!--? Footer Section -->
        <div class="row bottom sr3">

          <!--? Collapse Sidebar -->
          <div @click="collapseSidebar = !collapseSidebar" title="Toggle collapse sidebar"
            class="sidebar-collapse no-mobile">
            <img :src="$root.resolveIcon('assets/icons/sidebar-collapse.svg')">
          </div>

          <br>

          <!--? Buttons -->
          <div class="set">

            <!--? Open Settings -->
            <a @click="openSettings" title="Settings">
              <img :src="$root.resolveIcon('assets/icons/sidebar-settings.svg')" width="30">
            </a>

            <!--? Open Documentation -->
            <a title="Documentation" class="no-mobile sc ml10" target="_blank">
              <img :src="$root.resolveIcon('assets/icons/sidebar-help.svg')" width="30">
            </a>

          </div>

        </div>

      </div>
    </div>

    <!-- ? Main View -->
    <div class="main">

      <!--? TOAST Invite Sent -->
      <div class="aiko-toast" style="display: none">
        <p class="textinout">Sending invite</p><a>Undo</a>
        <div class="t-loader"><span></span></div>
      </div>

      <!--? TOAST Connection Lost -->
      <div class="aiko-toast" style="display: none">
        <p class="textinout" style="color: #dc3545 !important">We're having trouble connecting to the internet</p>
        <div class="t-loader-red"><span></span></div>
      </div>

      <!--? TOAST IMAP Error -->
      <div class="aiko-toast" style="display: none;">
        <p class="textinout" style="color: #dc3545 !important">
          We're having issues connecting to your mail provider, but will keep trying.
        </p>
        <div class="t-loader-red"><span></span></div>
      </div>

      <!--? TOAST Send Email Error -->
      <div class="aiko-toast" style="display: none;">
        <p class="textinout" style="color: #dc3545 !important">We were unable to send your message due to network
          issues</p>
        <div class="t-loader-red"><span></span></div>
      </div>

      <!--? TOAST Sending Email -->
      <div class="aiko-toast" style="display: none;">
        <p class="textinout">Sending email</p><a>Undo</a>
        <div class="t-loader"><span></span></div>
      </div>

      <!--? Top Bar -->
      <div class="header">
        <div class="container">
          <div class="row">

            <!-- ? Mailbox Picker -->
            <div class="col-lg-3 col-md-4 col-2">
              <div class="picker">

                <!-- Currently loaded mailbox -->
                <div class="account">
                  <img :src="avatar"> <span>{{imapConfig?.email}}</span>
                </div>

                <!-- Other mailboxes -->
                <div class="account" @click="switchMailbox(mailbox)" v-for="mailbox in mailboxes"
                  v-if="mailbox != imapConfig?.email">
                  <img :src="$root.resolveIcon('assets/icons/header-user.svg')"> <span>{{mailbox}}</span>
                  <span class="sec-notif"></span>
                </div>

                <div @click="flow.addMailbox = true" class="account">
                  <img :src="$root.resolveIcon('assets/icons/header-plus.svg')"> <span>Add a mailbox</span>
                </div>
              </div>
            </div>

            <!-- ? Search -->
            <div class="col-lg-5 col-md-6 col-6 p0m">
              <div class="search">
                <img :src="$root.resolveIcon('assets/icons/header-search.svg')"><input type="" name=""
                  placeholder="Search">
              </div>
              <!-- TODO: Rig search + search dropdown -->
              <div class="search-drop" style="display: none;">
                <a>
                  <div>Subject contains "<span>Ruben</span>"</div>
                </a>
                <hr>
                <p>People</p>
                <a>
                  <div>ruben@priansh.com</div>
                </a>
                <a>
                  <div>rubencharles@gmail.com</div>
                </a>
                <a>
                  <div>rubencharlestouitou@gmail.com</div>
                </a>
              </div>
            </div>

            <!-- ? Header Menu -->
            <div class="col-lg-4 col-md-2 col-4 text-right side" style="white-space: nowrap;">

              <!-- ? Open Calendar -->
              <a @click="openCalendar" class="inline" title="Show calendar">
                <img class="no-filter" :src="$root.resolveIcon('assets/icons/header-calendar.svg')">
              </a>

              <!-- ? Notifications -->
              <div class="dropdown inline">
                <a @click.stop.prevent="flow.showNotifications = !(flow.showNotifications)" title="Smart notifications">
                  <img class="no-filter" :src="$root.resolveIcon('assets/icons/header-bell.svg')">
                  <span class="notif-count">3</span>
                </a>
                <div v-if="flow.showNotifications" v-clickaway="() => flow.showNotifications = false"
                  class="dropdown-menu notif show" style="margin-top: 10px">
                  <div class="container">
                    <a>
                      <div class="row">
                        <div class="col-1">
                          <img :src="$root.resolveIcon('assets/icons/notif-click.svg')" width="10">
                        </div>
                        <div class="col-7 notif-c">
                          Ruben opened "Re: Meeting this saturday"
                        </div>
                        <div class="col-3 notif-t p0">
                          35m
                        </div>
                      </div>
                    </a>
                    <a>
                      <div class="row">
                        <div class="col-1">
                          <img :src="$root.resolveIcon('assets/icons/notif-invite.svg')" width="10">
                        </div>
                        <div class="col-7 notif-c">
                          Prinakashiose joined your team
                        </div>
                        <div class="col-3 notif-t p0">
                          3h
                        </div>
                      </div>
                    </a>
                    <a>
                      <div class="row">
                        <div class="col-1">
                          <img :src="$root.resolveIcon('assets/icons/notif-eye.svg')" width="10">
                        </div>
                        <div class="col-7 notif-c">
                          John opened "Can you meet at ..."
                        </div>
                        <div class="col-3 notif-t p0">
                          Yesterday
                        </div>
                      </div>
                    </a>
                  </div>
                </div>
              </div>

            </div>

          </div>
        </div>
      </div>

      <!--? Inbox Kanban Boards -->
      <div class="boards-container">
        <div :class="{
          'boards': true,
          'two-lines': true,
          'regular': flow.regularView
        }">

          <!-- ? Inbox Board (special case) -->
          <div :class="{
            'board': true,
            'inbox': true,
            'load-board': syncing
          }">

            <!-- ? Header -->
            <div class="board-header">
              <div class="container p0">
                <div class="row" style="display: -webkit-inline-box">

                  <!-- ? Actions Dropdown -->
                  <div class="col-1 cll">
                    <div class="dropdown">
                      <a @click.stop.prevent="flow.showInboxBoardActions = !flow.showInboxBoardActions"
                        title="Board options"><img :src="$root.resolveIcon('assets/icons/board-dots.svg')"></a>
                      <div v-clickaway="() => flow.showInboxBoardActions = false" v-if="flow.showInboxBoardActions"
                        class="dropdown-menu show">
                        <h6 class="dropdown-header">Actions</h6>
                        <a class="dropdown-item">Mark all as read</a>
                        <a class="dropdown-item">Mark all as unread</a>
                        <div class="dropdown-divider"></div>
                        <a @click.stop.prevent="flow.showBoardRules = true; flow.showInboxBoardActions = false"
                          class="dropdown-item">Board rules</a>
                      </div>
                    </div>
                  </div>


                  <!--? Controls Dropdown -->
                  <div class="col-1 cll">
                    <div class="dropdown">
                      <a @click.stop.prevent="flow.showInboxBoardControls = !flow.showInboxBoardControls"
                        title="Sort and filter emails"><img :src="$root.resolveIcon('assets/icons/sort.svg')"></a>
                      <div v-clickaway="() => flow.showInboxBoardControls = false" v-if="flow.showInboxBoardControls"
                        class="dropdown-menu show">
                        <h6 class="dropdown-header">Sort by</h6>
                        <a class="dropdown-item" @click.stop.prevent="sortThreads(true)">Date (newest)</a>
                        <a class="dropdown-item" @click.stop.prevent="sortThreads(false)">Date (oldest)</a>
                        <h6 class="dropdown-header">Display only</h6>
                        <a @click.stop.prevent="seenFilter = null" class="dropdown-item">All</a>
                        <a @click.stop.prevent="seenFilter = false" class="dropdown-item">Unread</a>
                        <a @click.stop.prevent="seenFilter = true" class="dropdown-item">Read</a>
                      </div>
                    </div>
                  </div>


                  <!--? Force Sync (inbox only) -->
                  <div class="col-1 cll">
                    <a v-if="backendSyncing" title="Force refresh">
                      <img class="rotating" :src="$root.resolveIcon('assets/icons/refresh.svg')" width="17">
                    </a>
                    <a v-if="!backendSyncing" @click="forceSync" title="Force refresh">
                      <img :src="$root.resolveIcon('assets/icons/refresh.svg')" width="17">
                    </a>
                  </div>


                  <!-- ? Priority/Other Switcher -->
                  <div class="col-8 text-center exp nowrap" id="step2">
                    <div class="inbox-switch left text-center">
                      <h1 :class="{
                        'inbox1': true,
                        'active': priority
                      }" @click="priority = true" inbox-direction="left">
                        Priority
                        <div class="secondary-count" title="Unread emails in your inbox">
                          {{smartPriorityUnread}}
                        </div>
                      </h1>
                      <h1 :class="{
                        'inbox2': true,
                        'active': !priority
                      }" @click="priority = false" inbox-direction="right">Others</h1>
                    </div>
                  </div>

                </div>
              </div>
            </div>


            <!-- ? Inbox Thread List -->
            <div v-if="!flow.regularView" ref="inboxBoard" @scroll="onScroll" class="board-body" id="step1">

              <!-- ? Draggable List -->
              <draggable id="aikomail--inbox" v-if="!loading" v-model="inbox" filter=".dont-drag-this"
                draggable=".email" ghost-class="ghost" :group="{name: 'emails'}" :force-fallback="true"
                :fallback-on-body="true" :fallback-tolerance="5" @end="moveThread" @clone="cloneThread">
                <!-- * We leave the slug prop out to indicate that it is in the inbox -->
                <thread-card v-for="(tid, i) in inbox"
                  v-if="threads[tid] && threads[tid].priority == priority && (seenFilter == null || threads[tid].seen == seenFilter)"
                  :key="tid" :sort="false" :render="i >= visibleMin && visibleMax >= i"
                  :focused-folder.camel="focused.folder" :focused-index.camel="focused.index"
                  :view-focused.camel="focused.view" :quick-focused.camel="focused.quickReply" :thread="threads[tid]"
                  :index="i"></thread-card>
              </draggable>


              <!-- ? List Loader -->
              <div class="inbox-more">
                <p @click="priority = false"><img :src="$root.resolveIcon('assets/icons/filter-inbox.svg')"> <span>Click
                    here to see
                  </span><b>{{otherInbox.length}}</b> filtered
                  <span>threads</span></p>
                <div class="load-bottom">
                </div>
              </div>

            </div>

            <!-- ? Inbox Thread List -->
            <div v-if="flow.regularView" ref="inboxBoard" @scroll="onScroll" class="board-body" id="step1">

              <!-- ? Draggable List -->
              <draggable id="aikomail--inbox" v-if="!loading" v-model="fullInbox" filter=".dont-drag-this"
                draggable=".email" ghost-class="ghost" :group="{name: 'emails'}" :force-fallback="true"
                :fallback-on-body="true" :fallback-tolerance="5" @end="moveThread" @clone="cloneThread">
                <!-- * We leave the slug prop out to indicate that it is in the inbox -->
                <thread-card v-for="(tid, i) in fullInbox"
                  v-if="threads[tid] && threads[tid].priority == priority && (seenFilter == null || threads[tid].seen == seenFilter)"
                  :key="tid" :sort="false" :render="i >= visibleMin && visibleMax >= i"
                  :focused-folder.camel="focused.folder" :focused-index.camel="focused.index"
                  :view-focused.camel="focused.view" :quick-focused.camel="focused.quickReply" :thread="threads[tid]"
                  :index="i"></thread-card>
              </draggable>


              <!-- ? List Loader -->
              <div class="inbox-more">
                <p @click="priority = false"><img :src="$root.resolveIcon('assets/icons/filter-inbox.svg')"> <span>Click
                    here to see
                  </span><b>{{otherInbox.length}}</b> filtered
                  <span>threads</span></p>
                <div class="load-bottom">
                </div>
              </div>

            </div>

          </div>


          <!-- ? Container for the other boards (draggable so you can adjust board order) -->
          <draggable v-if="!flow.regularView" style="display: inline-flex;" v-model="boardOrder"
            :group="{name: 'boards'}" draggable=".board" ghost-class="ghost" handle=".board-drag-handle"
            :force-fallback="true" :fallback-on-body="true" @end="reorderBoards" :fallback-tolerance="5">
            <!-- ? Board Template -->
            <board v-for="slug in boardOrder" :syncing="syncing" :board="resolveBoard(slug)" :slug="slug"
              :seen-filter.camel="seenFilter" inline-template>

              <div :class="{
                'board': true,
                'load-board': syncing,
                'thin': board?.thin
              }">

                <!-- ? Board Header -->
                <div class="board-header board-drag-handle">
                  <div class="container p0">
                    <div class="row">

                      <!-- ? Board Actions -->
                      <div class="col-2 cll">
                        <div class="dropdown">
                          <a @click.stop.prevent="showActions = !showActions" title="Board options"><img
                              :src="$root.resolveIcon('assets/icons/board-dots.svg')"></a>
                          <div v-if="showActions" v-clickaway="() => showActions = false" class="dropdown-menu show">
                            <h6 class="dropdown-header">Actions</h6>
                            <a @click.stop.prevent="showActions = true" class="dropdown-item">Mark all as read</a>
                            <a class="dropdown-item">Mark all as unread</a>

                            <!-- POTENTIAL COLOR ADD
                            <div class="dropdown-divider"></div>
                            <h6 class="dropdown-header">Board Color</h6>
                            <div class="radio-cont">
                              <input class="aiko-check ac1" type="radio" name="radioNoLabel" id="radioNoLabel1" value=""
                                aria-label="...">
                              <input class="aiko-check ac2" type="radio" name="radioNoLabel" id="radioNoLabel1" value=""
                                aria-label="...">
                              <input class="aiko-check ac3" type="radio" name="radioNoLabel" id="radioNoLabel1" value=""
                                aria-label="...">
                              <input class="aiko-check ac4" type="radio" name="radioNoLabel" id="radioNoLabel1" value=""
                                aria-label="...">
                              <input class="aiko-check ac5" type="radio" name="radioNoLabel" id="radioNoLabel1" value=""
                                aria-label="...">
                              <input class="aiko-check ac6" type="radio" name="radioNoLabel" id="radioNoLabel1" value=""
                                aria-label="...">
                              <input class="aiko-check ac7" type="radio" name="radioNoLabel" id="radioNoLabel1" value=""
                                aria-label="...">
                            </div>
                            -->
                            <div class="dropdown-divider"></div>
                            <a v-if="slug != 'Done'" class="dropdown-item">Rename
                              board</a>
                            <a v-if="slug != 'Done'" class="dropdown-item red" style="color: #dc3545 !important">Delete
                              board</a>
                            <a class="dropdown-item space-change">
                              Show in spaces:
                              <div class="space-select">
                                <!-- TODO: Make sure users HAVE to leave board checked in at least one space so it doesnt disappear in a limbo -->
                                <span>
                                  <div class="form-check">
                                    <label class="switch">
                                      <input type="checkbox">
                                      <span class="slider round"></span>
                                    </label>
                                    <label class="form-check-label" for="flexCheckDefault"> Home</label>
                                  </div>
                                  <div class="form-check">
                                    <label class="switch">
                                      <input type="checkbox">
                                      <span class="slider round"></span>
                                    </label>
                                    <label class="form-check-label" for="flexCheckDefault"> Cooley</label>
                                  </div>
                                  <div class="form-check">
                                    <label class="switch">
                                      <input type="checkbox">
                                      <span class="slider round"></span>
                                    </label>
                                    <label class="form-check-label" for="flexCheckDefault"> PM Team</label>
                                  </div>
                                  <p>Boards need to show<br>
                                    in at least one space</p>
                                </span>
                              </div>
                            </a>

                          </div>
                        </div>
                      </div>


                      <!-- ? Board Title (click to thin/thick) -->
                      <div class="col-8 text-center p0 exp margin-auto nowrap">
                        <h1 @click="board.thin = !board.thin" title="Click title to minimize/maximize">
                          {{slug}}
                        </h1>
                        <div v-if="unread > 0 && slug != 'Done'" class="secondary-count" title="Unread emails in board">
                          {{unread > 99 ? '99+' : unread}}
                        </div>
                        <div v-if="slug == 'Done'" class="archive" title="Trash entire board">
                          <img :src="$root.resolveIcon('assets/icons/sidebar-trash.svg')">
                          Trash all
                        </div>
                      </div>

                      <!-- ? Board Drag Handle -->
                      <div class="col-2 text-right cll">
                        <!-- ! Testing a UI without this -->
                        <a v-if="false" class="board-drag-handle" title="Drag board"><img
                            :src="$root.resolveIcon('assets/icons/board-dots2.svg')"></a>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- ? Board Thread List -->
                <div class="board-body">

                  <!-- ? Draggable List -->
                  <draggable :id="'aikomail--' + slug" v-if="board" v-model="board.tids" filter=".dont-drag-this"
                    draggable=".email" ghost-class="ghost" :group="{name: 'emails'}" :force-fallback="true"
                    :fallback-on-body="true" :fallback-tolerance="5" @start="startMove" @end="moveThread">
                    <thread-card v-for="(tid, i) in board.tids" v-if="(seenFilter == null || thread.seen == seenFilter)"
                      :key="tid" :sort="false" :render="true" :focused-folder.camel="focused.folder"
                      :focused-index.camel="focused.index" :view-focused.camel="focused.view"
                      :quick-focused.camel="focused.quickReply" :thread="threads[tid]" :index="i" :slug="slug">
                    </thread-card>
                  </draggable>

                  <!-- ? Board Empty Helper Text -->
                  <div class="empty" v-if="board?.tids?.length == 0">
                    <h1>Drag emails here.</h1>
                  </div>
                </div>
              </div>

            </board>
          </draggable>


          <!-- ? Thread View Pane for Regular View -->
          <div v-if="flow.regularView" class="long-board">
            <regular-view-thread v-if="flow.viewThread && flow.regularView" :thread="flow.viewThread" inline-template>
              <!-- ? Email List -->
              <div class="main-email">

                <!-- ? Datepicker for Schedule Quick Action -->
                <div class="modal-dialog modal-md datepick" v-if="false">
                  <div class="modal-content">
                    <div class="modal-reg">
                      <h1 class="mt-2">Please change or confirm suggested time.</h1>
                      <h2 class="mt-3 mb-2"><b>"Tomorrow after work"</b></h2>
                      <input type="datetime-local">
                      <br>
                      <label class="switch mr-1 mt-2">
                        <input type="checkbox" />
                        <span class="slider round cal"></span>
                      </label>
                      <p style="max-width: 300px;margin: auto;display: inline;">Add event to my calendar</p>
                      <br><br><br>
                      <div class="modal-bottom">
                        <a class="blue">Compose</a>
                      </div>
                      <p class="ns30"></p>
                      <br>
                    </div>
                  </div>
                </div>

                <!-- ? Thread Messages -->
                <view-email v-for="(email, i) in fullThread.emails" :email="email" :expanded="i == 0" :key="i"
                  :tid="thread.tid">
                </view-email>
              </div>
            </regular-view-thread>
          </div>


          <!-- ? Add Board Button -->
          <div v-if="!flow.regularView" class="add-board" @click="flow.addBoard = true" id="step3">
            <img :src="$root.resolveIcon('assets/icons/boards-add.svg')">
          </div>

        </div>
      </div>

    </div>

    <!--? MODAL Invite Team Member --------------------------------------->
    <div class="aiko-modal" style="display: none;">
      <div class="modal-dialog modal-sm">
        <div class="modal-content">
          <div class="modal-reg">
            <img :src="$root.resolveIcon('assets/icons/sidebar-invite.svg')" width="40" style="margin-bottom: 5px;">
            <h1>Invite a team member</h1>
            <h2>Enter their email address</h2>
            <input type="email" name="" placeholder="Email">
            <p>We'll send them a link to Aiko Mail.</p>
            <br>
            <a class="blue">Done</a>
            <p class="ns30"></p>
            <br>
          </div>
        </div>
      </div>
    </div>

    <!-- TODO: Rig MODAL Pick trash or archive --------------------------------------->
    <div class="aiko-modal" style="display: none;">
      <div class="modal-dialog modal-sm">
        <div class="modal-content">
          <div class="modal-reg">
            <h1>Trash or archive </h1>
            <h2>Do you wish to use trash or archive?</h2>
            <div class="container pr">
              <div class="row" style="user-select: none;">
                <div class="col-6">
                  <div class="btnrt">
                    <img :src="$root.resolveIcon('assets/icons/sidebar-trash.svg')" width="20">
                    <a>Trash</a>
                  </div>
                </div>
                <div class="col-6">
                  <div class="btnrt">
                    <img :src="$root.resolveIcon('assets/icons/sidebar-archive.svg')" width="20">
                    <a>Archive</a>
                  </div>
                </div>
              </div>
            </div>
            <br>
            <h2 class="mb0">This preference will be used from now</h2>
          </div>
        </div>
      </div>
    </div>

    <!--? MODAL Upgrade for Quick Actions -->
    <div class="aiko-modal" style="display: none;">
      <div class="modal-dialog modal-md">
        <div class="modal-content">
          <img :src="$root.resolveIcon('assets/icons/grey-x.svg')" data-dismiss="modal" class="x-email">
          <div class="modal-reg">
            <img v-if="isDarkMode" src="assets/img/logo-white.svg" width="140"
              style="margin-bottom: 15px;margin-top:10px">
            <img v-if="!isDarkMode" src="assets/img/logo.svg" width="140" style="margin-bottom: 15px;margin-top:10px">
            <h1>You found a premium feature.</h1>
            <img v-if="isDarkMode" src="assets/img/u-quick-black.png" width="300">
            <img v-if="!isDarkMode" src="assets/img/u-quick-white.png" width="300">
            <br>
            <p style="max-width: 400px;margin: auto;margin-bottom: 10px;">Quick actions detects intent in your emails
              and lets you manage them with the click of a button.</p><br> <br>
            <div class="modal-bottom">
              <a class="blue">Get Started</a>
            </div>
            <p class="ns30"></p>
            <br>
          </div>
        </div>
      </div>
    </div>

    <!--? MODAL Upgrade for more mailboxes -->
    <div class="aiko-modal" style="display: none;">
      <div class="modal-dialog modal-md">
        <div class="modal-content">
          <img :src="$root.resolveIcon('assets/icons/grey-x.svg')" data-dismiss="modal" class="x-email">
          <div class="modal-reg">
            <img v-if="isDarkMode" src="assets/img/logo-white.svg" width="140"
              style="margin-bottom: 15px;margin-top:10px">
            <img v-if="!isDarkMode" src="assets/img/logo.svg" width="140" style="margin-bottom: 15px;margin-top:10px">
            <h1>You found a premium feature.</h1>
            <img v-if="isDarkMode" src="assets/img/u-mailbox-black.png" width="250">
            <img v-if="!isDarkMode" src="assets/img/u-mailbox-white.png" width="250">
            <br> <br>
            <p style="max-width: 300px;margin: auto;margin-bottom: 10px;">Add email accounts and seamlessly switch
              between all your
              mailboxes.</p><br><br>
            <div class="modal-bottom">
              <a class="blue">Get Started</a>
            </div>
            <p class="ns30"></p>
            <br>
          </div>
        </div>
      </div>
    </div>

    <!--? MODAL Upgrade for notifications -->
    <div class="aiko-modal" style="display: none;">
      <div class="modal-dialog modal-md">
        <div class="modal-content">
          <img :src="$root.resolveIcon('assets/icons/grey-x.svg')" data-dismiss="modal" class="x-email">
          <div class="modal-reg">
            <img v-if="isDarkMode" src="assets/img/logo-white.svg" width="140"
              style="margin-bottom: 15px;margin-top:10px">
            <img v-if="!isDarkMode" src="assets/img/logo.svg" width="140" style="margin-bottom: 15px;margin-top:10px">
            <h1>You found a premium feature.</h1>
            <img v-if="isDarkMode" src="assets/img/u-notif-black.png" width="300">
            <img v-if="!isDarkMode" src="assets/img/u-notif-white.png" width="300">
            <br><br>
            <p style="max-width: 300px;margin: auto;margin-bottom: 10px;">Upgrade today to get notified when
              someone opens your emails or joins your team.</p><br> <br>
            <div class="modal-bottom">
              <a class="blue">Get Started</a>
            </div>
            <p class="ns30"></p>
            <br>
          </div>
        </div>
      </div>
    </div>

    <!--? MODAL Tutorial Video -->
    <tutorial-modal v-if="firstTime" inline-template>
      <div class="aiko-modal">
        <div class="modal-dialog modal-md">
          <div class="modal-content">
            <div class="modal-reg">
              <h1>Welcome to Aiko Mail</h1>
              <h2>Watch this tutorial to get started!</h2>
              <!-- TODO: change this to tutorial video once we have one -->
              <video controls src="assets/videos/"></video>
            </div>
            <br><br>
            <div class="modal-bottom">
              <a @click="close" class="blue" style="float: right;">Skip Tutorial</a>
            </div>
          </div>
        </div>
      </div>
    </tutorial-modal>

    <!--? MODAL View Thread -->
    <view-thread v-if="flow.viewThread && !flow.regularView" :thread="flow.viewThread" inline-template>

      <div @click.self="close" class="aiko-modal">

        <div class="modal-dialog modal-lg">

          <!--!------------------------------------------------------------->
          <!-- ? ESCAPE TIP -->
          <!--!------------------------------------------------------------->
          <p class="esc-tip">press <b>ESC</b></p>


          <!--!------------------------------------------------------------->
          <!-- ? Thread Container -->
          <!--!------------------------------------------------------------->
          <div class="modal-content">

            <!--!------------------------------------------------------------->
            <!-- ? Message List -->
            <!--!------------------------------------------------------------->
            <div class="main-email">

              <!--!------------------------------------------------------------->
              <!-- ? Datepicker for Schedule Quick Action -->
              <!-- TODO: move this out -->
              <!--!------------------------------------------------------------->
              <div class="modal-dialog modal-md datepick" v-clickaway="() => scheduleSeed = null" v-if="scheduleSeed">
                <div class="modal-content">
                  <div class="modal-reg">
                    <h1 class="mt-2">Please change or confirm suggested time.</h1>
                    <h2 class="mt-3 mb-2"><b>{{scheduleText}}</b></h2>
                    <input type="datetime-local" v-model="scheduleTime">
                    <br>
                    <label class="switch mr-1 mt-2">
                      <input v-model="scheduleToCalendar" type="checkbox" />
                      <span class="slider round cal"></span>
                    </label>
                    <p style="max-width: 300px;margin: auto;display: inline;">Add event to my calendar</p>
                    <br><br><br>
                    <div class="modal-bottom">
                      <a class="blue">Compose</a>
                    </div>
                    <p class="ns30"></p>
                    <br>
                  </div>
                </div>
              </div>

              <!-- TODO: Ruben, make sure shadow light mode not bad-->
              <!--!------------------------------------------------------------->
              <!-- ? Thread Messages -->
              <!--!------------------------------------------------------------->
              <view-email v-for="(email, i) in fullThread.emails" :email="email" :expanded="i == 0" :key="i"
                :tid="thread.tid" :seed-schedule.camel="seedSchedule">
              </view-email>
            </div>


            <!--!------------------------------------------------------------->
            <!-- ? Thread Sidebar -->
            <!--!------------------------------------------------------------->
            <div class="secondary-email">

              <!--!------------------------------------------------------------->
              <!-- ? Contact Information (probably move this to message header and replace with reply, reply all, etc) -->
              <!--!------------------------------------------------------------->
              <div class="secondary-head mh240" v-if="thread.participants.length > 0">
                <h3>Participants</h3>
                <div class="container">


                  <!--!------------------------------------------------------------->
                  <!-- ? Participant Avatar + Contact Info -->
                  <!--!------------------------------------------------------------->
                  <div v-for="participant in thread.participants" class="row h67">
                    <div class="col-3 p0">
                      <img :src="participant.avatar" class=" email-view-avatar">
                    </div>
                    <div class="col-9 p0 spe hover-name">
                      <h1>{{participant.name}}</h1>
                      <h2>{{participant.address}}</h2>

                      <p>NEW EMAIL</p> <!-- This is an option, could be anything we want really-->
                      <p>COPY</p> <!-- This is an option, could be anything we want really-->
                      <p>INVITE</p> <!-- This is an option, could be anything we want really-->
                    </div>
                  </div>

                </div>
              </div>

              <!--!------------------------------------------------------------->
              <!-- ? Board Change -->
              <!--!------------------------------------------------------------->
              <div class="dark-side">
                <h4>Current board</h4>
                <select class="aiko-select">
                  <option>{{board}}</option>
                </select>
              </div>

              <!--!------------------------------------------------------------->
              <!-- ? Related Threads -->
              <!--!------------------------------------------------------------->
              <h3>Related Conversations</h3>
              <div class="previous-threads sec-sec">
                <div class="email thread">
                  <div class="container pr">
                    <div class="row" style="user-select: none;">
                      <div class="col-8 p0" style="display: inline-flex;">
                        <p class="subject">This is the subject</p>
                      </div>
                      <div class="col-4 p0">
                        <div class="time">6:18PM</div>
                      </div>

                      <p class="body">This is the main content of the email, it is suppose to be
                        longer than the subject and a summary of the main content.</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </view-thread>

    <!--? MODAL Add Mailbox --------------------------------------->
    <add-mailbox-modal v-if="flow.addMailbox" :success="switchMailServer" :googlestrategy="google_addMailbox"
      :msftstrategy="msft_addMailbox" :closable="!(flow.forceAddMailbox)" inline-template>
      <div class="aiko-modal add-mailbox">
        <!-- STEP ONE --->
        <div class="modal-dialog modal-md" v-if="step == 1">
          <!--!------------------------------------------------------------->
          <!-- ? ESCAPE TIP -->
          <!-- TODO: Make Modal exitable by click out or ESC-->
          <!--!------------------------------------------------------------->
          <p class="esc-tip">press <b>ESC</b></p>

          <div class="modal-content">
            <div class="modal-reg">
              <h1>Add a mailbox</h1>
              <h2>Pick an email provider</h2>
              <!-- <a><img src="assets/img/icloud.png"></a> -->
              <a><img @click="addOutlook" src="assets/img/outlook.png"></a>
              <a><img @click="addGoogle" src="assets/img/google.png"></a>
              <!-- <a><img src="assets/img/yahoo.png"></a> -->
              <!-- <a><img src="assets/img/aol.png"></a> -->
              <a><img @click="addMicrosoft" src="assets/img/exchange.png"></a>
              <br>
            </div>
            <div class="modal-bottom">
              <a @click="addOther">Other</a>
            </div>
          </div>
        </div>
        <!-- STEP TWO --->
        <div class="modal-dialog modal-md" v-if="step == 2">
          <div class="modal-content">
            <div class="modal-reg">
              <h1>Add a mailbox</h1>
              <h2>Enter your credentials</h2>
              <a>
                <!-- TODO: use clearbit to auto-show the user's email provider -->
                <img v-if="imapConfig.provider == 'microsoft'" src="assets/img/outlook.png">
              </a>
              <p v-if="error" class="alert alert-danger">{{error}}</p>
              <input v-model="imapConfig.user" type="email" name="" placeholder="Email">
              <input v-model="imapConfig.pass" type="password" name="" placeholder="Password">
              <input v-model="imapConfig.host" type="url" name="" placeholder="IMAP Host">
              <input v-model="imapConfig.port" type="number" name="" placeholder="IMAP Port">
              <input v-model="smtpConfig.host" type="url" name="" placeholder="SMTP Host">
              <input v-model="smtpConfig.port" type="number" name="" placeholder="SMTP Port">
              <br><br>
              <a v-if="!loading" @click="saveConfig" class="blue">Add mailbox</a>
              <!-- TODO: CHANGE LOADER HERE RUBEN-->
              <div v-if="loading" class="cs-loader">
                <div class="cs-loader-inner">
                  <label> ●</label>
                  <label> ●</label>
                  <label> ●</label>
                  <label> ●</label>
                  <label> ●</label>
                  <label> ●</label>
                </div>
              </div>
              <br><br>
            </div>
            <div v-if="!loading" class="modal-bottom">
              <a @click="back">Back</a>
            </div>
          </div>
        </div>

      </div>
    </add-mailbox-modal>

    <!--? MODAL Add Board --------------------------------------->
    <add-board-modal v-if="flow.addBoard" inline-template>
      <div class="aiko-modal addb" @click.self="close">
        <div class="modal-dialog modal-sm">

          <!--!------------------------------------------------------------->
          <!-- ? ESCAPE TIP -->
          <!-- TODO: Make Modal exitable by  ESC-->
          <!--!------------------------------------------------------------->
          <p class="esc-tip">press <b>ESC</b></p>


          <div class="modal-content">

            <!--!------------------------------------------------------------->
            <!-- ? Board-Create Form -->
            <!--!------------------------------------------------------------->
            <div class="modal-reg">

              <img :src="$root.resolveIcon('assets/icons/new-board.svg')" width="40" style="margin-bottom: 5px;">

              <h1>Add a board</h1>

              <input v-model="name" type="text" placeholder="Board name" minlength="1" maxlength="13" class="cap"
                style="margin-top: -20px;" autofocus>

              <br><br>

              <div v-if="name && validBoard" class="modal-bottom">
                <!-- TODO: should automatically open the board rules modal for this board -->
                <a @click="addBoard">Add</a>
              </div>

              <div v-if="!name" class="modal-bottom">
                <h2>Please enter a name to continue.</h2>
              </div>

              <div v-if="!validBoard" class="modal-bottom">
                <h2 class="red">A board with that name already exists.</h2>
              </div>

              <br>

            </div>
          </div>
        </div>
      </div>
    </add-board-modal>

    <dev-controls v-if="flow.showDev" :delete-cache.camel="deleteCache" inline-template>
      <div style="z-index: 9999" class="aiko-modal" @click.self="close">
        <div class="modal-dialog modal-md">
          <div class="modal-content">
            <div class="modal-reg">
              <h1>Developer Controls</h1>
              <a>
                <img style="max-width: 190px; margin: auto" src="assets/img/logo.svg">
              </a>
              <br>
              <br>
              <a @click="deleteCache(emails=true)" class="btn btn-warning">Clear Email Cache</a>
              <br>
              <br>
              <a @click="deleteCache(prefs=true)" class="btn btn-warning">Clear Settings</a>
              <br>
              <br>
              <a @click="deleteCache(chrome=true)" class="btn btn-warning">Clear Inbox Cache</a>
              <br>
              <br>
              <a @click="deleteCache(emails=true, prefs=true, chrome=true)" class="btn btn-danger text-white">Clear ALL
                Cache</a>
              <br>
              <br>
              <a @click="testIMAP" class="btn btn-dark text-white">Test IMAP Connection</a>
              <img v-if="imapValid === true" style="filter: invert(1)"
                :src="$root.resolveIcon('assets/icons/check-circle.svg')">
              <img v-if="imapValid === false" :src="$root.resolveIcon('assets/icons/x-white.svg')">
              <br>
              <br>
              <a @click="testSMTP" class="btn btn-dark text-white">Test SMTP Connection</a>
              <img v-if="smtpValid === true" style="filter: invert(1)"
                :src="$root.resolveIcon('assets/icons/check-circle.svg')">
              <img v-if="smtpValid === false" :src="$root.resolveIcon('assets/icons/x-white.svg')">
              <br>
              <br>
              <a @click="testConnection" class="btn btn-light">Test Mail Connection</a>
              <br>
              <br>
              <br>
            </div>
            <div class="modal-bottom text-center">
              <a @click="close">Close</a>
            </div>
          </div>
        </div>
      </div>
    </dev-controls>

    <!--? MODAL Board Rules --------------------------------------->
    <board-rules v-if="flow.showBoardRules" inline-template>
      <div class="aiko-modal" @click.self="close">
        <div class="modal-dialog modal-md mw800">
          <div class="modal-content">
            <div class="modal-reg">
              <img :src="$root.resolveIcon('assets/icons/new-board.svg')" width="40" style="margin-bottom: 5px;">
              <h1>Board Rules</h1>
              <br>
              <div class="container-rules">
                <div class="row margin-auto existing-rules" v-for="rule in rules">
                  <div class="col-3">
                    <p class="margin-auto text-left">{{rule.condition.display}}</p>
                  </div>
                  <div class="col-3" v-if="!(rule.condition.valid)">
                    <p class="margin-auto blue text-left">"{{rule.condition.value}}"</p>
                  </div>
                  <div class="col-3" v-else>
                    <select class="aiko-select" v-model="rule.condition.value" disabled>
                      <option v-for="option in rule.condition.valid" :value="option.value">
                        {{option.display}}
                      </option>
                    </select>
                  </div>
                  <div class="col-2">
                    <p class="margin-auto text-left">{{rule.action.display}}</p>
                  </div>
                  <div class="col-2" v-if="!(rule.action.valid)">
                    <p class="margin-auto blue">{{rule.action.value}}</p>
                  </div>
                  <div class="col-2" v-else>
                    <select class="aiko-select" v-model="rule.action.value" disabled>
                      <option v-for="option in rule.action.valid" :value="option.value">
                        {{option.display}}
                      </option>
                    </select>
                  </div>
                  <div class="col-2">
                    <a class="red margin-auto text-right">Delete</a>
                  </div>
                </div>
              </div>
              <br>
              <div class="accordion">
                <div class="card b0">
                  <div class="card-header" style="background: var(--main-bg-color);">
                    <h2 class="mb-0">
                      <button @click="showAddRule = true" class="btn btn-link" type="button">
                        Add new rule
                      </button>
                    </h2>
                  </div>
                  <div :class="{
                    'collapse': true,
                    'show': showAddRule
                  }">
                    <div class="row margin-auto existing-rules">
                      <div class="col-3">
                        <select class="aiko-select" v-model="condition">
                          <option v-for="condition in validConditions" :value="condition.value">
                            {{condition.display}}
                          </option>
                        </select>
                      </div>

                      <!-- Inside this one will be dynamic depending on previous selection
                      (text/email/date etc)   --------------------------------------->
                      <div class="col-3" v-if="!(draftCondition.valid)">
                        <input type="text" name="rulesField" v-model="conditionValue" placeholder="...">
                      </div>
                      <div class="col-3" v-else>
                        <select class="aiko-select" v-model="conditionValue">
                          <option v-for="val in draftCondition.valid" :value="val.value">
                            {{val.display}}
                          </option>
                        </select>
                      </div>

                      <div class="col-2">
                        <select class="aiko-select" v-model="action">
                          <option v-for="action in validActions" :value="action.value">
                            {{action.display}}
                          </option>
                        </select>
                      </div>
                      <div class="col-2" v-if="!(draftAction.valid)">
                        <input type="email" name="rulesField" placeholder="Email">
                      </div>
                      <div class="col-2" v-else>
                        <select class="aiko-select" v-model="actionValue">
                          <option v-for="val in draftAction.valid" :value="val.value">
                            {{val.display}}
                          </option>
                        </select>
                      </div>
                      <div class="col-2" @click="addRule">
                        <a class="blue margin-auto text-right">Add</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="accordion">
                <div class="card b0">
                  <div class="card-header" style="background: var(--main-bg-color);">
                    <h2 class="mb-0">
                      <button @click="queueAll" class="btn btn-link" type="button">
                        Run all rules
                      </button>
                    </h2>
                  </div>
                </div>
              </div>
              <!--?Bottom text <p style="margin-top: 25px;margin-bottom: 0"></p> ---->
            </div>
          </div>
        </div>
      </div>
    </board-rules>

    <!--? MODAL Inbox Rules -------------------------------------->
    <div class="aiko-modal" style="display: none;">
      <div class="modal-dialog modal-md mw800">
        <div class="modal-content">

          <div class="modal-reg pb15">
            <img :src="$root.resolveIcon('assets/icons/new-board.svg')" width="40" style="margin-bottom: 5px;">
            <h1><b>Inbox</b> board rules</h1>
            <br>
            <div class="container-rules">
              <div class="row margin-auto existing-rules">
                <div class="col-3">
                  <p class="margin-auto text-left">if from: </p>
                </div>
                <div class="col-3">
                  <p class="margin-auto blue text-left">ruben@pri.com</p>
                </div>
                <div class="col-2">
                  <p class="margin-auto text-left">move to: </p>
                </div>
                <div class="col-2">
                  <p class="margin-auto blue">To-Do</p>
                </div>
                <div class="col-2">
                  <a class="red margin-auto text-right">Delete</a>
                </div>
              </div>

              <div class="row margin-auto existing-rules">
                <div class="col-3">
                  <p class="margin-auto text-left">Contains: </p>
                </div>
                <div class="col-3">
                  <p class="margin-auto blue text-left">salsa</p>
                </div>
                <div class="col-2">
                  <p class="margin-auto text-left">move to: </p>
                </div>
                <div class="col-2">
                  <p class="margin-auto blue">Done</p>
                </div>
                <div class="col-2">
                  <a class="red margin-auto text-right">Delete</a>
                </div>
              </div>

              <div class="row margin-auto existing-rules">
                <div class="col-3">
                  <p class="margin-auto text-left">if from: </p>
                </div>
                <div class="col-3">
                  <p class="margin-auto blue text-left">jojo@pri.com</p>
                </div>
                <div class="col-2">
                  <p class="margin-auto text-left">move to: </p>
                </div>
                <div class="col-2">
                  <p class="margin-auto blue">From Jo</p>
                </div>
                <div class="col-2">
                  <a class="red margin-auto text-right">Delete</a>
                </div>
              </div>

              <div class="row margin-auto existing-rules">
                <div class="col-3">
                  <p class="margin-auto text-left">if from: </p>
                </div>
                <div class="col-3">
                  <p class="margin-auto blue text-left">ruben@pri.com</p>
                </div>
                <div class="col-2">
                  <p class="margin-auto text-left">move to: </p>
                </div>
                <div class="col-2">
                  <p class="margin-auto blue">To-Do</p>
                </div>
                <div class="col-2">
                  <a class="red margin-auto text-right">Delete</a>
                </div>
              </div>
            </div>
            <br>
            <div class="accordion" id="accordionExample">
              <div class="card b0">
                <div class="card-header" id="headingOne" style="background: var(--main-bg-color);">
                  <h2 class="mb-0">
                    <button class="btn btn-link" type="button">
                      Add new rules
                    </button>
                  </h2>
                </div>
                <div class="collapse">
                  <div class="row margin-auto existing-rules">
                    <div class="col-3">
                      <select class="aiko-select">
                        <option value="1" selected="selected">If from: </option>
                        <option value="2">If contains: </option>
                        <option value="2">If date: </option>
                        <option value="2">If flagged: </option>
                        <option value="2">If attcht: </option>
                        <option value="2">If contains: </option>
                        <option value="2">If contains: </option>

                      </select>
                    </div>


                    <!-- Inside this one will be dynamic depending on previous selection
                  (text/email/date etc)   --------------------------------------->
                    <div class="col-3">
                      <input type="text" name="rulesField" placeholder="Email">
                    </div>



                    <div class="col-2">
                      <p class="margin-auto text-left">move to: </p>
                    </div>
                    <div class="col-2">
                      <select class="aiko-select">
                        <option value="1" selected="selected">To-Do</option>
                        <option value="2">Done</option>
                      </select>
                    </div>
                    <div class="col-2">
                      <a class="blue margin-auto text-right">Add</a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


  <!--? Thread Card -->
  <script type="text/x-template" id="thread-card">
    <div @blur="unfocus" :ref="thread.tid" :key="thread.tid" :tid="thread.tid" :class="{
        'email': true,
        'unread': !(thread.seen),
        'zero': !(thread.emails[0].M.summary.sentences.length > 0),
        'syncing': thread.syncing,
        'dont-drag-this': thread.syncing,
        'starred': thread.starred,
        'just-me': justMe,
        'quick-reply': showQuickReply,
        'pre-delete': deleting,
        'focus': ($root.regularView && $root.flow.viewThread) ? ($root.flow.viewThread?.tid == thread.tid) : false
      }">

      <!-- ? Card content -->
      <div v-if="render !== false" class="container pr" @click="viewMessage">

        <!--!------------------------------------------------------------->
        <!-- ? Preview latest message -->
        <!--!------------------------------------------------------------->
        <div class="row" style="user-select: none;">

          <!--!------------------------------------------------------------->
          <!-- ? Card Header -->
          <!--!------------------------------------------------------------->
          <div class="col-8 p0 exp" style="display: inline-flex;">

            <!--!------------------------------------------------------------->
            <!-- ? Participants -->
            <!--!------------------------------------------------------------->
            <h2 class="sender" @click="debug" v-if="!justMe">
              {{thread.participants.slice(0, 3).map(({ name, address }) => name || address).join(', ')}}
            </h2>
            <h2 class="sender" @click="debug" v-if="justMe">
              Me
            </h2>

            <!--!------------------------------------------------------------->
            <!-- ? Thread indicators -->
            <!--!------------------------------------------------------------->
            <img v-if="thread.emails.length > 1" :src="$root.resolveIcon('assets/icons/thread.svg')"
              title="Number of emails in this thread">
            <span class="thread-count" v-if="thread.emails.length > 1">{{thread.emails.length}}</span>

            <!--!------------------------------------------------------------->
            <!-- ? Email badges -->
            <!--!------------------------------------------------------------->
            <img v-if="thread.hasAttachments" :src="$root.resolveIcon('assets/icons/badges-attach.svg')"
              title="This email has attachments">
            <img v-if="thread.hasTrackers" :src="$root.resolveIcon('assets/icons/badges-tracker.svg')"
              title="Tracker in this email successfully blocked">
            <img v-if="quickaction == 'calendar_invite'" :src="$root.resolveIcon('assets/icons/badges-event.svg')"
              title="This email contains an event">
            <img v-if="thread.bcced" :src="$root.resolveIcon('assets/icons/badges-bcc.svg')" title="You were BCC'ed">
          </div>

          <!--!------------------------------------------------------------->
          <!-- ? Prettified Date -->
          <!--!------------------------------------------------------------->
          <div class="col-4 p0 cll">
            <div class="time">{{thread.date.toNiceDateTime(6)}}</div>
          </div>

          <!--!------------------------------------------------------------->
          <!-- ? Subject (cleaned) -->
          <!--!------------------------------------------------------------->
          <p class="subject">{{thread.emails[0].M.envelope.cleanSubject}}</p>

          <!--!------------------------------------------------------------->
          <!-- ? Summarized Content -->
          <!--!------------------------------------------------------------->
          <p v-if="thread.emails[0].M.summary.sentences.length > 0" class="body" id="step4">
            {{thread.emails[0].M.summary.text}}</p>
        </div>

        <!--!------------------------------------------------------------->
        <!-- ? Card Footer -->
        <!--!------------------------------------------------------------->
        <div class="email-footer dont-drag-this" style="user-select: none;" id="step5">
          <div class="row">
            <!--!------------------------------------------------------------->
            <!-- ? Quick Actions -->
            <!--!------------------------------------------------------------->
            <div class="col-5 cll2 z1 spp">
              <a v-if="quickaction == 'scheduling'" class="main-action blue">
                <img :src="$root.resolveIcon('assets/icons/badges-event-blue.svg')"> Schedule
              </a>
              <a @click.stop.prevent="openLink" v-if="quickaction == 'verify'" class="main-action blue">
                <img :src="$root.resolveIcon('assets/icons/link.svg')"> Verify
              </a>
              <a @click.stop.prevent="openLink" v-if="quickaction == 'subscribe'" class="main-action blue">
                <img :src="$root.resolveIcon('assets/icons/link.svg')"> Subscribe
              </a>
              <a @click.stop.prevent="openLink" v-if="quickaction == 'unsubscribe'" class="main-action red">
                <img :src="$root.resolveIcon('assets/icons/options-unsub.svg')"> Unsubscribe
              </a>
              <a v-if="quickaction == 'sign_document'" class="main-action blue">
                <img :src="$root.resolveIcon('assets/icons/sign.svg')"> Sign
              </a>
              <a v-if="quickaction == 'send_document'" class="main-action blue">
                <img :src="$root.resolveIcon('assets/icons/attach.svg')"> Attach files
              </a>
              <a v-if="quickaction == 'calendar_invite'" class="main-action blue">
                <img :src="$root.resolveIcon('assets/icons/badges-event-blue.svg')"> Add to Calendar
              </a>
              <a @click.stop.prevent="copyOTP"
                v-if="quickaction == 'confirm_code' && thread.emails[0].M.quick_actions.otp" class="main-action blue">
                <img :src="$root.resolveIcon('assets/icons/clipboard.svg')"> {{thread.emails[0].M.quick_actions.otp}}
              </a>
              <a @click="viewMessage" v-if="quickaction == 'confirm_code' && !(thread.emails[0].M.quick_actions.otp)"
                class="main-action blue">
                <img :src="$root.resolveIcon('assets/icons/link.svg')"> Get Code
              </a>
              <a @click.stop.prevent="openLink" v-if="quickaction == 'override'" class="main-action blue">
                <img :src="thread.emails[0].M.quick_actions.overrideIcon">
                {{thread.emails[0].M.quick_actions.overrideText}}
              </a>
              <a @click.stop.prevent="showQuickReply = true" v-if="!quickaction" class="main-action ma1">
                <img :src="$root.resolveIcon('assets/icons/zap.svg')"> Quick Reply <span
                  @click.prevent="quickReplyAll = true" class="all">All</span>
              </a>
            </div>

            <!--!------------------------------------------------------------->
            <!-- ? Sync Indicator -->
            <!--!------------------------------------------------------------->
            <div v-if="thread.syncing" class="col-5 sync-message">
              <a class="main-action ma1" title="Waiting for your email provider">
                <img :src="$root.resolveIcon('assets/icons/refresh.svg')" class="rotating ml5"> Syncing
              </a>
            </div>

            <!--!------------------------------------------------------------->
            <!-- ? Common Interactions -->
            <!--!------------------------------------------------------------->
            <div class="col-7 extra-actions  cll2 cll">
              <!-- TODO: Once email has been replied to, change below to 'options-replied.png'-->
              <a v-if="isRepliedTo" @click.stop.prevent="reply" title="You've replied to this email"><img
                  :src="$root.resolveIcon('assets/icons/options-replied.png')" width="18"></a>
              <a v-else @click.stop.prevent="reply"><img :src="$root.resolveIcon('assets/icons/options-reply.png')"
                  width="18"></a>
              <a @click.stop.prevent="replyAll"><img :src="$root.resolveIcon('assets/icons/options-replya.png')"
                  width="18"></a>
              <a @click.stop.prevent="forward"><img :src="$root.resolveIcon('assets/icons/options-forward.png')"
                  width="15"></a>
              <a @click.stop.prevent="starMessage" v-if="!(thread.starred)"><img
                  :src="$root.resolveIcon('assets/icons/options-star.svg')" width="15"></a>
              <a @click.stop.prevent="unstarMessage" v-if="thread.starred"><img
                  :src="$root.resolveIcon('assets/icons/badges-star.svg')" width="15"></a>
              <a @click.stop.prevent="deleteMessage" ><img :src="$root.resolveIcon('assets/icons/options-trash.svg')"
                  class="red-h" width="15"></a>
            </div>
          </div>
        </div>

        <!--!------------------------------------------------------------->
        <!-- ? Quick Actions -QUICK REPLY-->
        <!--!------------------------------------------------------------->
        <div :class="{
          'note': true,
          'hide': !showQuickReply,
          'dont-drag-this': true
        }">
          <input @keydown.esc.stop.prevent="unfocus" @click.stop="focus" ref="quickreply" @blur="unfocus"
            v-model="replyText" placeholder="Type a reply, press enter to send." autofocus>
          <a @click.stop="sendQuickReply"><img :src="$root.resolveIcon('assets/icons/compose-send.svg')" width="20"></a>
        </div>

        <!--!------------------------------------------------------------->
        <!-- ? Quick Actions - SCHEDULE-->
        <!--!------------------------------------------------------------->
        <div :class="{
          'dpick': true,
          'hide': true,
          'dont-drag-this': true
        }">
          <input type="datetime-local" id="birthdaytime" name="birthdaytime">
          <a @click.stop="sendQuickReply"><img :src="$root.resolveIcon('assets/icons/calendar.svg')" width="20"></a>
        </div>



      </div>


      <!-- ? Show empty card if it is not supposed to be visible -->
      <div style="height: 106px;" v-else></div>
    </div>
  </script>


  <!-- ? View Singular Email -->
  <script type="text/x-template" id="view-email">
    <div :class="{
      'single-email': true,
      'short': !expanded
    }">

      <!--!------------------------------------------------------------->
      <!-- ? Message Header -->
      <!--!------------------------------------------------------------->
      <div class="email-head" @click="expanded = !expanded">
        <div class="container">
          <!--!------------------------------------------------------------->
          <!-- ? Preview Metadata -->
          <!--!------------------------------------------------------------->
          <div class="row">
            <div class="w65">
              <img :src="avatar" class="email-view-avatar">
            </div>
            <div class="w65p">
              <div class="container">
              <div class="row sender-top">
                <div class="col-8 p0" style="display: inline-flex;height: 22px;">

                  <!--!------------------------------------------------------------->
                  <!-- ? Message Sender -->
                  <!--!------------------------------------------------------------->

                  <h2 class="sender">
                    {{email.M.envelope.from.name || email.M.envelope.from.address}}
                  </h2>


                  <!--!------------------------------------------------------------->
                  <!-- ? Message Badges -->
                  <!--!------------------------------------------------------------->
                  <img v-if="email.parsed?.attachments?.length > 0"
                    :src="$root.resolveIcon('assets/icons/badges-attach.svg')">
                  <img v-if="email.M.tracker" :src="$root.resolveIcon('assets/icons/badges-tracker.svg')">
                  <img v-if="email.M.quick_actions.classification == 'calendar_invite'"
                    :src="$root.resolveIcon('assets/icons/badges-event.svg')">
                  <img v-if="email.M.envelope.bcc.length > 0" :src="$root.resolveIcon('assets/icons/badges-bcc.svg')">

                </div>
                <div class="col-4 p0">
                  <div class="time">{{new Date(email.M.envelope.date).toNiceDateTime(6)}}</div>
                </div>
              </div>

              <!--!------------------------------------------------------------->
              <!-- ? More Metadata -->
              <!--!------------------------------------------------------------->
              <div class="row">
                <h2 class="fromto-info" @click.stop.prevent="showSenderInfo = !showSenderInfo">

                  <!--!------------------------------------------------------------->
                  <!-- ? Singular Direct Recipient, Collapsed -->
                  <!--!------------------------------------------------------------->
                  <div v-if="!showSenderInfo && email.M.envelope.recipients.length <= 1">
                    <b>From</b>
                    <span>{{email.M.envelope.from.address}}</span>
                    <b>to</b>
                    <span v-if="email.M.envelope.recipients.length > 0">{{email.M.envelope.recipients[0].address}}</span>
                    <span v-else>undisclosed recipients</span>
                  </div>


                  <!--!------------------------------------------------------------->
                  <!-- ? Multiple Direct Recipients, Collapsed -->
                  <!--!------------------------------------------------------------->
                  <div v-if="!showSenderInfo && email.M.envelope.recipients.length > 1">
                    <b>From</b>
                    <span>{{email.M.envelope.from.address}}</span>
                    <b>to</b>
                    <span v-for="to in email.M.envelope.recipients.slice(0, 2)">{{to.address}}</span>
                    <b v-if="email.M.envelope.recipients.length > 2">
                      and
                      {{Math.max(email.M.envelope.recipients.length - 2, 0)}}
                      others
                    </b>
                  </div>


                  <!--!------------------------------------------------------------->
                  <!-- ? Any Recipient, Expanded -->
                  <!--!------------------------------------------------------------->
                  <div v-if="showSenderInfo" class="more-fromto">
                    <b>From </b>
                    <span>{{(email.M.envelope.from.name && (email.M.envelope.from.name != email.M.envelope.from.address)) ? '"' + email.M.envelope.from.name + '" ' : ''}}
                      {{email.M.envelope.from.address}}</span>
                    <br>
                    <b>To </b>
                    <span
                      v-for="to in email.M.envelope.to">{{(to.name && (to.name != to.address)) ? '"' + to.name + '" ' : ''}}
                      {{to.address}}</span>
                    <br v-if="email.M.envelope.cc.length > 0">
                    <b v-if="email.M.envelope.cc.length > 0">CC </b>
                    <span
                      v-for="cc in email.M.envelope.cc">{{(cc.name && (cc.name != cc.address)) ? '"' + cc.name + '" ' : ''}}
                      {{cc.address}}</span>
                    <br v-if="email.M.envelope.bcc.length > 0">
                    <b v-if="email.M.envelope.bcc.length > 0">BCC </b>
                    <span
                      v-for="bcc in email.M.envelope.bcc">{{(bcc.name && (bcc.name != bcc.address)) ? '"' + bcc.name + '" ' : ''}}
                      {{bcc.address}}</span>
                  </div>
                </h2>
              </div>
              </div>
            </div>
          </div>

          <!--!------------------------------------------------------------->
          <!-- ? Subject -->
          <!--!------------------------------------------------------------->
          <div class="row mw-140">
            <h3>{{email.M.envelope.subject}}</h3>
          </div>


          <!--!------------------------------------------------------------->
          <!-- ? Quick Actions -->
          <!--!------------------------------------------------------------->
          <div class="options-qa">
            <a @click.stop.prevent="schedule" v-if="email.M.quick_actions.classification == 'scheduling'">
              <h2><img :src="$root.resolveIcon('assets/icons/email-schedule.svg')">Schedule</h2>
            </a>
            <a @click.stop.prevent="openVerify" v-if="email.M.quick_actions.classification == 'verify'">
              <h2><img :src="$root.resolveIcon('assets/icons/link.svg')">Verify</h2>
            </a>
            <a v-if="email.M.quick_actions.classification == 'subscribe'">
              <h2><img :src="$root.resolveIcon('assets/icons/link.svg')">Subscribe</h2>
            </a>
            <a v-if="email.M.quick_actions.classification == 'unsubscribe'">
              <h2 class="red"><img :src="$root.resolveIcon('assets/icons/options-unsub.svg')">Unsubscribe</h2>
            </a>
            <a v-if="email.M.quick_actions.classification == 'sign_document'">
              <h2><img :src="$root.resolveIcon('assets/icons/sign.svg')">Sign</h2>
            </a>
            <a v-if="email.M.quick_actions.classification == 'send_document'">
              <h2><img :src="$root.resolveIcon('assets/icons/attach.svg')">Attach Files</h2>
            </a>
            <a v-if="email.M.quick_actions.classification == 'calendar_invite'">
              <h2><img :src="$root.resolveIcon('assets/icons/email-schedule.svg')">Add to Calendar</h2>
            </a>
            <a @click.stop.prevent="copyOTP" v-if="email.M.quick_actions.classification == 'confirm_code' && email.M.quick_actions.otp">
              <h2><img :src="$root.resolveIcon('assets/icons/clipboard.svg')">COPY CODE</h2>
            </a>
            <a @click.stop.prevent="openLink" v-if="email.M.quick_actions.classification == 'override'">
              <h2>
              <img :src="email.M.quick_actions.overrideIcon">
                {{thread.emails[0].M.quick_actions.overrideText}}
              </h2>
            </a>
          </div>


          <!--!------------------------------------------------------------->
          <!-- ? Message Interactions -->
          <!--!------------------------------------------------------------->
          <div class="options">
            <div class="container">
              <div class="row">
                <a @click.stop="reply" title="Reply"><img :src="$root.resolveIcon('assets/icons/options-reply.png')" width="21"></a>
                <a @click.stop="replyAll" title="Reply All"><img :src="$root.resolveIcon('assets/icons/options-replya.png')" width="20"></a>
                <a @click.stop="forward" title="Forward"><img :src="$root.resolveIcon('assets/icons/options-forward.png')" width="19"></a>
                <a title="Star" @click.stop.prevent="starMessage" v-if="!(thread.starred)">
                  <img :src="$root.resolveIcon('assets/icons/options-star.svg')" width="19">
                </a>
                <a title="Unstar" @click.stop.prevent="unstarMessage" v-if="thread.starred">
                  <img :src="$root.resolveIcon('assets/icons/badges-star.svg')" width="19">
                </a>
                <a title="Print" @click.stop.prevent="printMessage">
                  <img :src="$root.resolveIcon('assets/icons/options-print.svg')" width="20"></a>
                <a title="Trash" @click.stop.prevent="deleteMessage">
                  <img :src="$root.resolveIcon('assets/icons/options-trash.svg')" class="red-h" width="17"></a>
              </div>
            </div>
          </div>
        </div>
      </div>


      <!--!------------------------------------------------------------->
      <!-- ? Message Content -->
      <!--!------------------------------------------------------------->
      <div class="email-body">

        <!--!------------------------------------------------------------->
        <!-- ? Scheduler Mini-Tool -->
        <!--!------------------------------------------------------------->
        <div v-if="false" class="scheduler">
          <p title="Click to change date and time">(new Date(email.M.quick_actions.start)).toNicerDateTime()</p>
          <a>
            <img :src="$root.resolveIcon('assets/icons/event-white.svg')" width="20" />
            <span>Schedule</span>
          </a>
          <div class="scheduler2">
            <!-- TODO: Add calendar view here + design it-->
          </div>
          <!-- TODO: Not sure what to use this text for yet-->
          <span class="sc-info">This will open the composer</span>
        </div>


        <!--!------------------------------------------------------------->
        <!-- ? Message Loader -->
        <!--!------------------------------------------------------------->
        <div v-if="!(email.parsed) || loading" class="load-bottom">
          <p>Loading content</p>
        </div>


        <!--!------------------------------------------------------------->
        <!-- ? Message Body -->
        <!-- FIXME: using iframe right now, will be insecure until I safely inject HTML, see
          https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Safely_inserting_external_content_into_a_page -->
        <!--!------------------------------------------------------------->
        <iframe scrolling="no" frameborder="no" class="html-content email-iframe" :id="iframeId" src="">
        </iframe>


        <!--!------------------------------------------------------------->
        <!-- ? Attachments -->
        <!--!------------------------------------------------------------->
        <div class="attachments" v-if="email.parsed.attachments.length > 0">
          <div class="attachment" v-for="attachment in email.parsed.attachments" v-if="!(attachment.related)">
            <!-- TODO: map attachment.contentType (MIMEtype) to icon -->
            <!-- TODO: add name of attachment to title="" tag so they can hover and see full long name -->
            <img :src="$root.resolveIcon('assets/icons/music.svg')">
            <div class="name">{{attachment.filename || 'No Filename'}}</div>
            <div class="size">{{attachment.size.toFilesize()}}</div>
          </div>
        </div>

      </div>
    </div>
  </script>

  <script>
    let app = null
  </script>
  <!--! 3rd party libraries -->
  <script src="assets/js/third-party/popper.min.js"></script>
  <script src="assets/js/third-party/jquery.amsify.suggestags.js"></script>
  <script src="assets/js/third-party/bootstrap.min.js"></script>
  <script src="assets/js/third-party/jwt-decode.min.js"></script>
  <script src="assets/js/third-party/jsrsasign.min.js"></script>
  <script src="assets/js/third-party/localforage.min.js"></script>
  <script src="assets/js/third-party/sortable.min.js"></script>
  <script src="assets/js/third-party/vue.min.js"></script>
  <script src="assets/js/third-party/vue-draggable.min.js"></script>
  <script src="assets/js/third-party/chrono.min.js"></script>
  <script src="assets/js/third-party/crypto.js"></script>
  <script src="assets/js/third-party/hotkeys.min.js"></script>
  <script src="assets/js/third-party/twitter-text.min.js"></script>
  <script src="assets/js/third-party/linkify.min.js"></script>
  <script src="assets/js/third-party/anchorme.min.js"></script>
  <script src="assets/js/third-party/shepherd.min.js"></script>
  <script src="assets/js/third-party/svg2png.js"></script>
  <script src="assets/js/third-party/jdenticon.min.js"></script>
  <script src="assets/js/third-party/boring-avatars.min.js"></script>
  <script src="assets/js/third-party/colorthief.min.js"></script>
  <script src="assets/js/third-party/color2filter.min.js"></script>
  <script src="assets/js/third-party/Dwarfhaven.min.js"></script>

  <!-- TODO: minify all sources into one js file -->
  <!--! common libraries -->
  <script src="assets/js/common/clickaway.js"></script>
  <script src="assets/js/common/icon-definitions.js"></script>
  <script src="assets/js/services/helpers/icons.js"></script>
  <script src="assets/js/cache/satellite.js"></script>
  <script src="assets/js/cache/dwarf-star.js"></script>
  <script src="assets/js/cache/gas-giant.js"></script>
  <script src="assets/js/common/jammer.js"></script>
  <!--? Services -->
  <script src="assets/js/services/workers/ipc.js"></script>
  <script src="assets/js/services/helpers/aiko.js"></script>
  <script src="assets/js/services/helpers/window.js"></script>
  <!--? OAuth -->
  <script src="assets/js/services/oauth/oauth.js"></script>
  <script src="assets/js/services/oauth/goauth.js"></script>
  <script src="assets/js/services/oauth/msoauth.js"></script>
  <!--? Mail-related -->
  <script src="assets/js/services/email/engine.js"></script>
  <script src="assets/js/services/email/mail.js"></script>
  <!--? Composer -->
  <script src="assets/js/services/composer/composer.js"></script>
  <!--? Calendar -->
  <script src="assets/js/services/calendar/calendar.js"></script>
  <!-- ? Settings -->
  <script src="assets/js/services/settings/settings.js"></script>
  <!--? Modals-->
  <script src="assets/js/services/helpers/flow.js"></script>
  <!--? Shortcuts -->
  <script src="assets/js/services/workers/shortcuts.js"></script>
  <!--? Components -->
  <script src="assets/js/components/modals/tutorial.js"></script>
  <script src="assets/js/components/modals/add-mailbox.js"></script>
  <script src="assets/js/components/modals/view-thread.js"></script>
  <script src="assets/js/components/regular-view-thread.js"></script>
  <script src="assets/js/components/modals/add-board.js"></script>
  <script src="assets/js/components/modals/dev-controls.js"></script>
  <script src="assets/js/components/modals/board-rules.js"></script>
  <script src="assets/js/components/thread-card.js"></script>
  <script src="assets/js/components/view-email.js"></script>
  <script src="assets/js/components/board.js"></script>
  <script src="assets/js/components/tour.js"></script>
  <!--? Entrypoint -->
  <script src="assets/js/entrypoints/inbox.js"></script>


</body>

</html>